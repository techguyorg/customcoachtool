# Pull Request Validation Pipeline
# Runs on every PR to validate code quality

trigger: none

pr:
  branches:
    include:
      - main
      - develop

pool:
  vmImage: 'ubuntu-latest'

variables:
  nodeVersion: '20.x'

jobs:
  - job: Validate
    displayName: 'Validate Pull Request'
    steps:
      - task: NodeTool@0
        inputs:
          versionSpec: $(nodeVersion)
        displayName: 'Install Node.js'

      - script: |
          npm ci
        displayName: 'Install dependencies'

      - script: |
          npm run lint
        displayName: 'Run ESLint'

      - script: |
          npx tsc --noEmit
        displayName: 'TypeScript type check'

      - script: |
          npm run build
        displayName: 'Verify build succeeds'
        env:
          VITE_SUPABASE_URL: 'https://placeholder.supabase.co'
          VITE_SUPABASE_PUBLISHABLE_KEY: 'placeholder-key'

      # Uncomment when tests are added
      # - script: |
      #     npm run test:ci
      #   displayName: 'Run tests'
